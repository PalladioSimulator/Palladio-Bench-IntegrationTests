--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _isefcNkNEeeBVcEmtPHXxw,_HLaB4AtnEeipvdTWhxg1oA,_2jg7UNkNEeeBVcEmtPHXxw,_FMHjcNkOEeeBVcEmtPHXxw
Element-Name: SIMUCOM-51 Linking Resource Test with Middleware Marshalling
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _tAO10Bx6Eei5XJvfSE2NEQ
Runtime-Version: 2.2.0.201706152316
Save-Time: 2/28/18 3:25 PM
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

Netzwerk Simulation Test mit Middleware Marshalling: PCM Instanz starten, Linking Resource Test Projekt laden(Link funktioniert nicht), als LR-Test mit MM ausführen, Konsolen Ausgabe auf folgenden Text überprüfen:
C1 sends two parameters to C2 with 3 characterisations:
* param.NUMBER_OF_ELEMENTS is 10, and param is an Int array
* param.BYTESIZE is 1000
* aString.BYTESIZE is 333
The middleware can decide how to handle the size of the int array. At this time, the default glassfish model creates an additional bytesize of 2 * NUMBER_OF_ELEMENTS.
Thus, with the glassfish model in the same folder, the network should be loaded with a demand of 1353. With the network throughput of 10, that is an actual demand of 135.3 plus the latency, which is 0.01, so 135.31 is the final network load.
The simulation output should say at some point (if verbose output is log level debug are enabled):
"DEBUG: A network load of 135.31 has been determined. [de.uka.ipd.sdq.simucomframework.resources.SimulatedLinkingResource]"
 For the communication back from the second component to the first, the RETURN.BYTESIZE is set to 500. Thus, a final network demand of 50.01 should be determined (including latency).
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-view "Project Explorer" | get-tree | select "LinkingResource_Test" | key-type F5 | get-menu -path "Rename..." | click
with [get-window "Rename Resource"] {
    get-editbox -after [get-label "New name:"] | set-text "LinkingResourceTest"
    get-button OK | click
}

get-view "Project Explorer" | get-tree | select "LinkingResourceTest" | get-menu -path "Run As/Run Configurations..." | click
with [get-window "Run Configurations"] {
    get-tree | select "SimuBench/LinkingResourceTest with Middleware Marshalling"
    get-tab-folder | get-tab-item Simulation | click
    with [get-group "Simulation Results"] {
        get-combo -after [get-label "Persistence Framework:"] 
            | select "Experiment Data Persistency & Presentation (EDP2)"
        get-group "Data Set" | get-button "Browse..." | click
    }
    with [get-window "Select Datasource..."] {
    	get-button "Add.." | click
        get-window "Open EDP2 Data Source" | get-button Finish | click
        get-table | select "LocalMemoryRepository.*"
        get-button OK | click
    }
    get-button Apply | click
    get-button Run | click
}

with [get-view Experiments] {
    click
    get-tree | select "Local Memory.*"
    get-button "Export Repository to CSV files" | click
}
with [get-window "Select Batch Export Target Folder"] {
    get-group "Location:" | get-button "Workspace..." | click
    with [get-window "Folder Selection"] {
        get-tree | select "LinkingResourceTest"
        get-button OK | click
    }
    get-button Finish | click
}

with [get-view "Project Explorer" | get-tree] {
    select "LinkingResourceTest" | get-menu -path Refresh | click
    select "LinkingResourceTest/LinkingResourceTest_with_Middleware_Marshalling__.*/Default_Variation_.*/.*/Linking_Resource_aName_Resource_Demand_Tuple.csv"
	| get-menu -path Copy | click
    select "LinkingResourceTest" | get-menu -path Paste | click
}

get-view "Project Explorer" | get-tree | select "LinkingResourceTest/Linking_Resource_aName_Resource_Demand_Tuple.csv" 
    | get-menu -path "Rename..." | click
with [get-window "Rename Resource"] {
    get-editbox -after [get-label "New name:"] | set-text "Linking_Resource_MM_aName_Resource_Demand_Tuple.csv"
    get-button OK | click
}

assert-tables-match [read-csv-file "workspace:/LinkingResourceTest/Linking_Resource_MM_aName_Resource_Demand_Tuple.csv" | select-columns "Resource Demand[s]"] [read-csv-file "workspace:/LinkingResourceTest/LinkResTestMMReferenceResource_Demand_Tuple.csv" | select-columns "Resource Demand[s]"]
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
